
f0=0; f1=1; f2=3; f3=2; f4=0;
x0=0; x1=1; x2=2; x3=3; x4=4;

fg=[0 1 3 2 0];
xx=[0 1 2 3 4];

figure(4); clf;

st=-1;
en=0;
x=st:0.1:en;
s= (32/28)*x;
plot(x,s); hold on;

st=0;
en=1;
x=st:0.1:en;
s=( - 1/35)* 3 + (32/28)*x;
plot(x,s); hold on;

st=1;
en=2;
x=st:0.1:en;
s=( - 1/35)*(2 - x).*(x.^2 - 4*x - 53) - (3/7)*(x - 1).*(2*x.^ 2 - 5*x - 9);   
plot(x,s); hold on;

st=2;
en=3;
x=st:0.1:en;
s=( - 3/7)*(3 - x).*(2*x.^ 2 - 12*x + 11) + (1/28)*(x - 2).*(13*x.^ 2 - 52*x + 54) ; 
plot(x,s); hold on;

st=3;
en=4;
x=st:0.1:en;
s=(1/35)*(3 - x).*(15*x.^ 2 - 106*x + 250);
plot(x,s); hold on;

st=4;
en=5;
x=st:0.1:en;
s=(- 16/35)*(x - 4);
plot(x,s); hold on;
plot(xx,fg,'r.'), hold on;


% 
% { (32/28)*x                                                                                -Åá < x ? 0,
% ( - 1/35)* 3 + (32/28)*x                                                                        0 ? x ? 1,
% ( - 1/35)(2 - x)(x ^2 - 4x - 53) - (3/7)(x - 1)(2x^ 2 - 5x - 9)               1 ? x ? 2,
% ( - 3/7)(3 - x)(2x^ 2 - 12x + 11) + (1/28)(x - 2)(13x^ 2 - 52x + 54)        2 ? x ? 3,
% (1/35)(3 - x)(15x^ 2 - 106x + 250)                                                          3 ? x ? 4,
% ( - 16/35)(x - 4)                                                                                       4 < x < Åá .
% }

x=-1:0.1:5;
p1= @(x) ((x-x1).*(x-x2).*(x-x3))/((x0-x1).*(x0-x2).*(x0-x3))*f0+...
         ((x-x0).*(x-x2).*(x-x3))/((x1-x0).*(x1-x2).*(x1-x3))*f1+...
         ((x-x0).*(x-x1).*(x-x3))/((x2-x0).*(x2-x1).*(x2-x3))*f2+ ...
         ((x-x0).*(x-x1).*(x-x2))/((x3-x0).*(x3-x1).*(x3-x2))*f3;
  figure(9); clf;
  
  plot(x,p1(x),'b-'), hold on;
plot(xx,fg,'r.','MarkerSize',20), hold on;


